(()=>{"use strict";const e=window.wp.data,t=window.wp.url,o=window.wp.hooks,c=(e,t,{leading:o}={})=>{let c;return(...i)=>{!c&&o&&e(...i),clearTimeout(c),c=setTimeout((()=>e(...i)),t)}},i=c((e=>setKlaviyoCookie(e)),1e3),a=c(((e,t)=>makePublicAPIcall(e,t)),1e3),l=c((()=>n.trackStartedCheckout()),1e3),n=window.WCK||{};n.trackStartedCheckout=function(){var e={};if(kl_checkout.email)e.email=kl_checkout.email;else{if(!kl_checkout.exchange_id)return;e._kx=kl_checkout.exchange_id}makePublicAPIcall("client/events/",buildEventRequestPayload(e,kl_checkout.event_data,{name:"Started Checkout",service:"woocommerce"}))},window.addEventListener("load",(function(){const c={};(0,o.addAction)("experimental__woocommerce_blocks-checkout-set-email-address","klaviyo-checkout-block",(()=>{const{billingAddress:{email:o}}=(0,e.select)("wc/store/cart").getCustomerData();(0,t.isEmail)(o)&&(c.email=o,identify_object.properties=c,kl_checkout.email=o,klaviyo.identify(identify_object.properties),l())})),(0,o.addAction)("experimental__woocommerce_blocks-checkout-set-billing-address","klaviyo-checkout-block",(()=>{const{billingAddress:{first_name:t,last_name:o}}=(0,e.select)("wc/store/cart").getCustomerData();t&&(c.first_name=t),o&&(c.last_name=o),identify_object.properties=c,i(c),a("client/profiles/",buildProfileRequestPayload(identify_object))}))}))})();