function closestParent(e,t){for(;e;){if(e.matches(t))return e;e=e.parentElement}return null}function shoppress_drawer_init(){jQuery(document).on("click",".sp-drawer-click",function(e){e.preventDefault();var e=void 0!==jQuery(this).data("drawer-target")?jQuery(this).data("drawer-target"):"",t=jQuery(this),e=e?jQuery("#"+e):t.closest(".sp-drawer"),t=(e.find(".sp-drawer-content-wrap"),e.hasClass("sp-open-drawer"));jQuery(".sp-drawer").removeClass("sp-open-drawer"),t?e.removeClass("sp-open-drawer"):e.addClass("sp-open-drawer")}),jQuery(document).on("click",".sp-drawer-close",function(e){jQuery(this).closest(".sp-drawer").removeClass("sp-open-drawer")})}function shoppress_accordion_init(){function s(e,t){for(;e;){if(e.matches(t))return e;e=e.parentElement}return null}document.addEventListener("click",function(e){var t,r,n,e=e.target;!e.classList.contains("sp-accordion-item-header")&&null===e.closest(".sp-accordion-item-header")||(n=s(e,".sp-accordions-container"),t=(e=s(e,".sp-accordion-item")).querySelector(".sp-accordion-item-content"),r=e.classList.contains("open"),n.querySelectorAll(".sp-accordion-item").forEach(function(e){e.classList.remove("open")}),n=t.scrollHeight,t.style.maxHeight=r?"":n+"px",r)||e.classList.add("open")})}function shoppress_quantity_controls_init(){document.addEventListener("click",function(e){var t;!e.target.classList.contains("sp-quantity-control")&&null===e.target.closest(".sp-quantity-control")||(e.preventDefault(),t=e.target.classList.contains("sp-quantity-control")?e.target:e.target.closest(".sp-quantity-control"),e=closestParent(e.target,".sp-quantity-input-modern-wrap").querySelector("input[type=number]"),t.classList.contains("minus")?e.stepDown():e.stepUp(),t=new Event("change",{bubbles:!0}),e.dispatchEvent(t))})}function sp_slider_init(){var e=jQuery(".sp-slider");if(!(0!==e.length))return!1;jQuery.each(e,function(e,t){t=jQuery(t);!1===t.hasClass("sp-slider-init")&&(t.slick(),t.addClass("sp-slider-init"))})}function sp_product_slider_init(){var e=jQuery(".sp-products-slider"),t=0!==e.length;let s="slick"in jQuery.fn&&"function"==typeof jQuery.fn.slick;if(!t)return!1;jQuery.each(e,function(e,t){var t=jQuery(t),r=t.data("spslider")??{},t=t.find(".products"),n=0!==t.length;s&&n&&!1===t.hasClass("sp-slider-init")&&(t.slick(r),t.addClass("sp-slider-init"))})}function sp_thumbnail_loop_slider(){var e=jQuery(".sp-loop-slider a");if(!(0!==e.length))return!1;e.on("click",function(e){var t=jQuery(e.target);(t.closest(".slick-arrow").length||t.closest(".slick-dots").length)&&e.preventDefault()})}(a=>{function r(e,t){(t=t||a(".woocommerce-notices-wrapper:first")||a(".wc-empty-cart-message").closest(".woocommerce")||a(".woocommerce-cart-form")).hasClass("woocommerce-notices-wrapper")&&t.empty(),t.prepend(e)}a(document).ready(function(){sp_slider_init(),sp_product_slider_init(),sp_thumbnail_loop_slider(),shoppress_drawer_init(),shoppress_accordion_init(),shoppress_quantity_controls_init(),a(document.body).on("sp_update_fragments",function(e,t){void 0!==t.fragments&&a.each(t.fragments,function(e,t){a(e).replaceWith(t)}),void 0!==t.message_html&&r(t.message_html),a(document.body).trigger("sp_fragments_refreshed")}),a(document).on("click",".sp-addtocart",function(){let t=a(this);t.addClass("loading");var e=a(this).data("product_id");0<a(".post-"+e+" .product_type_variable").length?window.location.href=a(".post-"+e+" .product_type_variable").attr("href"):(a(".post-"+e+" .add_to_cart_button").first().click(),setTimeout(function(){a.ajax({type:"POST",url:shoppress_frontend.ajax.url,data:{action:"sp_mc_update",nonce:shoppress_frontend.ajax.nonce},success:function(e){a(".sp-mc-item").html(e.content),a(".sp-cart-items-count, .sp-mc-item .sp-header-cart span").html(e.count),a(".elementor-widget-kata-plus-cart .count").html(e.count),t.removeClass("loading")},error:function(e){console.log(e),t.removeClass("loading")}})},1e3))}),a(document.body).on("removed_from_cart",function(e,t,r,n){var s,o=0<n.closest("#sp-mini-cart-drawer").length,n=0<n.closest("#sp-mc-drawer-menu_cart").length;o?(s=a(t["#sp-mini-cart-drawer"]).clone().wrap("<div />"),s=a(s).addClass("sp-open-drawer"),t["#sp-mini-cart-drawer"]=s):n&&(s=a(t["#sp-mc-drawer-menu_cart"]).clone().wrap("<div />"),s=a(s).addClass("sp-open-drawer"),t["#sp-mc-drawer-menu_cart"]=s)}),a(document).on("click",".sp-close-popup",function(){a(this).closest(".sp-popup-overlay").fadeOut()}),a(document).on("click",function(e){!a(e.target).hasClass("sp-open-dropdown")&&!a(e.target).closest(".sp-open-dropdown").length&&0==a(e.target).closest(".sp-dropdown-opened").length&&(a(".sp-dropdown-opened").fadeOut(500),a(".sp-dropdown-opened").removeClass("sp-dropdown-opened"))}),a(window).width()<=480&&a('[class*="dropdown"]').each(function(){a(this).attr("class").includes("sp-header-toggle")&&a(this).attr("class",function(e,t){return t.replace(/dropdown/g,"drawer")})}),a(document).on("added_to_cart",function(e,t,r,n){shoppress_frontend.mini_cart_drawer?.open_mini_cart_drawer_on_add_to_cart&&setTimeout(function(){a("#sp-mini-cart-drawer").addClass("sp-open-drawer"),a(document).trigger("sp-auto-opened-mini-cart-drawer")},500)}),a(document).on("sp-auto-opened-mini-cart-drawer",function(e){void 0!==shoppress_frontend.mini_cart_drawer.open_mini_cart_drawer_on_add_to_cart&&shoppress_frontend.mini_cart_drawer.open_mini_cart_drawer_on_add_to_cart&&void 0!==shoppress_frontend.mini_cart_drawer.auto_close_mini_cart_drawer&&shoppress_frontend.mini_cart_drawer.auto_close_mini_cart_drawer&&setTimeout(function(){a("#sp-mini-cart-drawer").removeClass("sp-open-drawer")},1e3*shoppress_frontend.mini_cart_drawer.auto_close_mini_cart_drawer_time)}),a(document).on("submit","form.sp-form-coupon",function(e){e.preventDefault();var t=a(this);t.block({message:null,overlayCSS:{background:"#FFF",opacity:.6}}),a.post(shoppress_frontend.ajax.url,{action:"sp_apply_coupon",coupon_code:t.find('[name="coupon_code"]').val()},function(e){e&&(a(document.body).on("sp_fragments_refreshed",function(){a("#sp-mini-cart-drawer").addClass("sp-open-drawer")}),a(document.body).trigger("sp_update_fragments",[e.data]),t.unblock())})}),a(document).on("change",".sp-cart-item-quantity .quantity .qty",function(e){e.preventDefault();var t=a(this);t.block({message:null,overlayCSS:{background:"#FFF",opacity:.6}}),a.post(shoppress_frontend.ajax.url,{action:"sp_update_item_quantity",cart_item_key:a(this).closest(".sp-cart-item-pr").data("cart_item_key"),quantity:a(this).val()},function(e){e&&(r(e.message_html),a(document.body).trigger("wc_fragment_refresh"),a(document.body).on("wc_fragments_refreshed",function(){a("#sp-mini-cart-drawer").addClass("sp-open-drawer")}),t.unblock())})}),a(document).on("click",".sp-share-link-wrapper .sp-copy-to-clipboard",function(e){var t,r;t=a(this).closest(".sp-share-link-wrapper").find(".sp-share-link-input"),r=a("<input>"),a("body").append(r),r.val(a(t).val()).select(),document.execCommand("copy"),r.remove()}),a(document).trigger("sp-frontend-init")})})(jQuery);